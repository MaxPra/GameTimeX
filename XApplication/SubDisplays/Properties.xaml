<Window
    x:Class="GameTimeX.Properties"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="Properties"
    Width="560"
    Height="415"
    AllowsTransparency="True"
    Background="Transparent"
    Loaded="Window_Loaded"
    MouseLeftButtonDown="Window_MouseLeftButtonDown"
    PreviewKeyDown="Window_PreviewKeyDown"
    Style="{StaticResource DefaultWindowStyle}"
    WindowStartupLocation="CenterOwner"
    WindowStyle="None"
    mc:Ignorable="d">

    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="0"
            CornerRadius="0"
            GlassFrameThickness="0" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <sys:Double x:Key="FormControlHeight">32</sys:Double>
        <Thickness x:Key="FormRowSpacing">0,3,0,3</Thickness>

        <Style
            x:Key="IconOnlyButton"
            BasedOn="{StaticResource NormalGuiButton}"
            TargetType="Button">
            <Setter Property="Width" Value="56" />
            <Setter Property="Height" Value="{StaticResource FormControlHeight}" />
            <Setter Property="Margin" Value="{StaticResource FormRowSpacing}" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style
            x:Key="FormTextBox_Local"
            BasedOn="{StaticResource FormTextBox}"
            TargetType="TextBox">
            <Setter Property="Height" Value="{StaticResource FormControlHeight}" />
            <Setter Property="Margin" Value="{StaticResource FormRowSpacing}" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>
    </Window.Resources>

    <Border
        Background="#2F2F2F"
        BorderBrush="{DynamicResource ButtonDefaultBrush}"
        BorderThickness="1"
        CornerRadius="12"
        SnapsToDevicePixels="True">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="28" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  Titlebar  -->
            <Border
                Grid.Row="0"
                Background="Black"
                ClipToBounds="True"
                CornerRadius="12,12,0,0" />
            <TextBlock
                Grid.Row="0"
                Margin="10,0,0,0"
                VerticalAlignment="Center"
                Foreground="White"
                Text="Properties" />

            <StackPanel
                Grid.Row="0"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <Button
                    x:Name="btnClose"
                    Width="40"
                    Height="28"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="btnClose_Click"
                    Content="X"
                    Foreground="White"
                    Style="{StaticResource NoMouseOverButtonStyle}">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border
                                x:Name="bg"
                                Background="{TemplateBinding Background}"
                                CornerRadius="0,12,0,0">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="bg" Property="Background" Value="Red" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="bg" Property="Background" Value="#CC0000" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </StackPanel>

            <!--  Inhalt  -->
            <Grid
                x:Name="grdContent"
                Grid.Row="1"
                Margin="18">
                <!--  Spalten: Felder | Spacer | Icon-Buttons  -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="12" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Reihen: Status | Name | Pic | Folder | Profile settings (HDR+Params) | Füller | Save  -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <!--  0 Status  -->
                    <RowDefinition Height="Auto" />
                    <!--  1 Name  -->
                    <RowDefinition Height="Auto" />
                    <!--  2 Pic path  -->
                    <RowDefinition Height="Auto" />
                    <!--  3 Game folder  -->
                    <RowDefinition Height="Auto" />
                    <!--  4 Profile settings group  -->
                    <RowDefinition Height="*" />
                    <!--  5 filler  -->
                    <RowDefinition Height="Auto" />
                    <!--  6 Save  -->
                </Grid.RowDefinitions>

                <!--  Steam profile linked bar  -->
                <Border
                    x:Name="bSteamProfileLinked"
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Margin="0,0,0,8"
                    Padding="6,2"
                    Background="#3A3A3A"
                    CornerRadius="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Links: Haken + Text  -->
                        <StackPanel
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,6,0"
                                FontWeight="Bold"
                                Foreground="{DynamicResource ButtonDefaultBrush}"
                                Text="✔" />
                            <TextBlock
                                VerticalAlignment="Center"
                                Foreground="White"
                                Text="Steam profile linked" />
                        </StackPanel>

                        <!--  Rechts: rotes X  -->
                        <Button
                            x:Name="btnUnlinkSteamProfile"
                            Grid.Column="1"
                            Width="24"
                            Height="24"
                            Margin="8,0,0,0"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            Click="btnUnlinkSteamProfile_Click"
                            Content="✖"
                            Foreground="White">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border
                                        x:Name="bg"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="4">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="bg" Property="Background" Value="Red" />
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="bg" Property="Background" Value="#CC0000" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </Border>

                <!--  Profile name  -->
                <TextBox
                    x:Name="txtProfileName"
                    Grid.Row="1"
                    Grid.Column="0"
                    Style="{StaticResource FormTextBox_Local}"
                    Tag="Profile name" />

                <!--  Steam Import button  -->
                <Button
                    x:Name="btnImportFromSteam"
                    Grid.Row="1"
                    Grid.Column="2"
                    Click="btnImportFromSteam_Click"
                    Style="{StaticResource IconOnlyButton}"
                    ToolTip="Import game from steam">
                    <Image
                        Width="30"
                        Height="30"
                        Source="{StaticResource steamImportImage}"
                        Stretch="Uniform" />
                </Button>

                <!--  Picture path  -->
                <TextBox
                    x:Name="txtPicPath"
                    Grid.Row="2"
                    Grid.Column="0"
                    IsReadOnly="True"
                    Style="{StaticResource FormTextBox_Local}"
                    Tag="Picture path" />

                <!--  Choose pic (Icon)  -->
                <Button
                    x:Name="btnShowFileDialog"
                    Grid.Row="2"
                    Grid.Column="2"
                    Click="btnShowFileDialog_Click"
                    Style="{StaticResource IconOnlyButton}"
                    ToolTip="Choose pic">
                    <Image
                        Width="18"
                        Height="18"
                        Source="{StaticResource picture}"
                        Stretch="Uniform" />
                </Button>

                <!--  Game folder  -->
                <TextBox
                    x:Name="txtGameFolderPath"
                    Grid.Row="3"
                    Grid.Column="0"
                    Style="{StaticResource FormTextBox_Local}"
                    Tag="Game folder (opt.)">
                    <TextBox.ToolTip>
                        <ToolTip
                            Background="#333333"
                            BorderThickness="1"
                            Foreground="White">
                            <TextBlock TextWrapping="Wrap">
                                If specified, GameTimeX will automatically get the exe and switch between profiles (enable in settings).
                            </TextBlock>
                        </ToolTip>
                    </TextBox.ToolTip>
                </TextBox>

                <!--  Choose folder (Icon)  -->
                <Button
                    x:Name="btnShowFileDialogExe"
                    Grid.Row="3"
                    Grid.Column="2"
                    Click="btnShowFileDialogExe_Click"
                    Style="{StaticResource IconOnlyButton}"
                    ToolTip="Choose folder">
                    <Image
                        Width="18"
                        Height="18"
                        Source="{StaticResource folder}"
                        Stretch="Uniform" />
                </Button>

                <!--  Profile settings (group)  -->
                <GroupBox
                    x:Name="gbProfileSettings"
                    Grid.Row="4"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Margin="0,12,0,0"
                    Header="Profile settings"
                    Style="{StaticResource CardGroupBox}">
                    <StackPanel>
                        <!--  HDR toggle  -->
                        <CheckBox
                            x:Name="cbEnableHdr"
                            Margin="0,0,0,10"
                            Content="Enable HDR before launching game"
                            Style="{StaticResource CheckBoxDefaultStyle}"
                            ToolTipService.ShowDuration="20000">
                            <CheckBox.ToolTip>
                                <ToolTip
                                    Background="#333333"
                                    BorderThickness="1"
                                    Foreground="White">
                                    <TextBlock Width="320" TextWrapping="Wrap">
                                        When enabled, GameTimeX will attempt to enable Windows HDR before launching the game and, if desired, disable it once the game has closed.
                                    </TextBlock>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>

                        <!--  Steam launch parameters  -->
                        <TextBox
                            x:Name="txtSteamParams"
                            Margin="0,0,0,0"
                            Style="{StaticResource FormTextBox_Local}"
                            Tag="Steam launch parameters"
                            ToolTipService.ShowDuration="20000">
                            <TextBox.ToolTip>
                                <ToolTip
                                    Background="#333333"
                                    BorderThickness="1"
                                    Foreground="White">
                                    <TextBlock Width="320" TextWrapping="Wrap">
                                        Optional Steam launch parameters (e.g. -fullscreen, -novid).
                                    </TextBlock>
                                </ToolTip>
                            </TextBox.ToolTip>
                        </TextBox>
                    </StackPanel>
                </GroupBox>

                <!--  Save  -->
                <Button
                    x:Name="btnSave"
                    Grid.Row="6"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Margin="0,8,0,2"
                    HorizontalAlignment="Stretch"
                    Click="btnSave_Click"
                    Content="Save"
                    Style="{StaticResource NormalGuiButton}" />
            </Grid>
        </Grid>
    </Border>
</Window>
